{% extends "base.html" %}

{% load static %}

{% block title %}Login{% endblock %}

{% block content %}
<div class="row text-center vertical-middle-sm">
    <h3 class="text-center bg-info p-2 text-white mb-0">登录</h3>

    {% if form.errors %}
        <p>Your username and password didn't match. Please try again.</p>
    {% endif %}

    <p>Input your username and password</p>

    {% if next %}
    <form class="form-horizontal" action="{% url 'account:user_login' %}?next={{next}}" method="post" >
    {% else %}
    <form class="form-horizontal" action="{% url 'account:user_login' %}" method="post">
    {% endif %}
        {% csrf_token %}


        <div class="form-group">
            <label for="{{ form.username.id_for_label }}" class="col-md-5 control-label" style="color:red">
                <span class="glyphicon glyphicon-user"></span>Username</label> <div class="col-md-6 text-left">{{ form.username }}</div>
        </div>
{#用户名#}


        <div class="form-group">
            <label for="{{ form.password.id_for_label }}" class="col-md-5 control-label" style="color:blue">
                <span class="glyphicon glyphicon-floppy-open"></span>Password</label>
            <div class="col-md-6 text-left">{{ form.password }}</div>
        </div>
{#    密码#}
         <div class="form-group">
                {{ form.captcha.errors }}
                <label for="{{ form.captcha.id_for_label }}" class="col-md-5 control-label" style="color:blue">
                <span class="glyphicon glyphicon-floppy-open"></span>验证码</label>
            <div class="col-md-6 text-left">{{ form.captcha }}</div>
            </div>
        <input type="submit" class="btn btn-primary btn-lg" value="Login">
    </form>

</div>
 <script>
        $(function () {
            // Add refresh button after field (this can be done in the template as well)
            $('img.captcha').after(
                $('<a class="btn btn-sm text-white btn-info  captcha-refresh">看不清</a>')
            );

            $('.captcha-refresh').click(function () {
                var $form = $(this).parents('form');
                var url = location.protocol + "//" + window.location.hostname + ":"
                    + location.port + "/captcha/refresh/";

                // Make the AJAX-call
                $.getJSON(url, {}, function (json) {
                    $form.find('input[name="captcha_0"]').val(json.key);
                    $form.find('img.captcha').attr('src', json.image_url);
                });
                return false;
            });
        });
    </script>

{% endblock %}